<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<title>BET/UserGuide</title>
<link rel="stylesheet" type="text/css" media="all" charset="utf-8" href="fsl/css/common.css">
<link rel="stylesheet" type="text/css" media="screen" charset="utf-8" href="fsl/css/screen.css">
<link rel="stylesheet" type="text/css" media="print" charset="utf-8" href="fsl/css/print.css">
<style type="text/css">
ul.pagetitle{
  display: inline;
  margin: 0;
  padding: 0;
  font-size: 1.5em;
}
li.pagetitle{
  display: inline;
  margin: 0;
}
td.noborder {
  border: 0;
}
</style>
</head>
<body>
<table>
<tr>
<td class="noborder">
<img src="logo.png">
</td>
<td class="noborder">
<ul class="pagetitle">
<li class="pagetitle"><a class="backlink">BET/UserGuide</a>
</ul>
<br><br>
[<a href="FSL.html">FSL</a>]&nbsp;[<a href="TitleIndex.html">TitleIndex</a>]&nbsp;[<a href="WordIndex.html">WordIndex</a>]&nbsp;
</td>
</tr>
</table>
<hr>
<div id="page">
<div dir="ltr" id="content" lang="en"><span class="anchor" id="top"></span>
<span class="anchor" id="line-1"></span><span class="anchor" id="line-2"></span><span class="anchor" id="line-3"></span><p class="line867"><div class="FslToolContents">
<h1>Contents</h1>
<ol><li><a href="./BET.html">Introduction</a></li><li>User Guide<div class="contentslist"><div class="table-of-contents"><p class="table-of-contents-heading">Contents<ol><li>
<a href="#Bet_Programs">Bet Programs</a></li><li>
<a href="#bet_and_bet2">bet and bet2</a><ol><li>
<a href="#Main_bet2_options:">Main bet2 options:</a></li><li>
<a href="#Variations_on_default_bet2_functionality_.28mutually_exclusive_options.29:">Variations on default bet2 functionality (mutually exclusive options):</a></li></ol></li><li>
<a href="#Bet_GUI">Bet GUI</a><ol><li>
<a href="#Main_Options">Main Options</a></li><li>
<a href="#Advanced_Options">Advanced Options</a></li></ol></li><li>
<a href="#betsurf">betsurf</a></li></ol></div></div></li><li><a href="./BET(2f)FAQ.html">FAQ</a></li></ol></div> <span class="anchor" id="line-4"></span>
<h1 id="Bet_Programs">Bet Programs</h1>
<span class="anchor" id="line-5"></span><span class="anchor" id="line-6"></span><ul><li><p class="line891"><a href="./BET(2f)UserGuide.html#bet">bet</a> - the main command-line script which makes calling the core bet2 and betsurf programs easy <span class="anchor" id="line-7"></span><ul><li><p class="line891"><a href="./BET(2f)UserGuide.html#bet">bet2</a> - the main brain extraction program <span class="anchor" id="line-8"></span></li><li><p class="line891"><a href="./BET(2f)UserGuide.html#betsurf">betsurf</a> - using a registered T1 and T2 image pair, estimates inner and outer skull surfaces and outer scalp surface <span class="anchor" id="line-9"></span></li></ul></li><li><p class="line891"><a href="./BET(2f)UserGuide.html#betgui">Bet</a> - the BET GUI <span class="anchor" id="line-10"></span></li></ul><p class="line862">Changes: The old C program called <tt class="backtick">bet</tt> has now been discontinued; the <tt class="backtick">bet2</tt> C++ program gives almost identical results. <tt class="backtick">betall</tt> has been replaced by the -A and -A2 options in the new <tt class="backtick">bet</tt> script. <tt class="backtick">betfunc</tt> has been replaced by the -F option in <tt class="backtick">bet</tt>. <tt class="backtick">betpremask</tt> has been replaced by the -b option in <tt class="backtick">standard_space_roi</tt>. <tt class="backtick">betsmallz</tt> has been replaced by the -Z option in <tt class="backtick">bet</tt>. <span class="anchor" id="line-11"></span><hr /><p class="line874"> <span class="anchor" id="line-12"></span><span class="anchor" id="bet"></span> <span class="anchor" id="line-13"></span>
<h1 id="bet_and_bet2">bet and bet2</h1>
<span class="anchor" id="line-14"></span><span class="anchor" id="line-15"></span><p class="line862">By default <tt class="backtick">bet</tt> just calls the <tt class="backtick">bet2</tt> program for simple brain extraction. However, it also allows various additional behaviour. The basic usage is: <span class="anchor" id="line-16"></span><span class="anchor" id="line-17"></span><p class="line867"><tt class="backtick">bet&nbsp;&lt;input&gt;&nbsp;&lt;output&gt;&nbsp;[options]</tt> <span class="anchor" id="line-18"></span><span class="anchor" id="line-19"></span><p class="line867">
<h2 id="Main_bet2_options:">Main bet2 options:</h2>
<span class="anchor" id="line-20"></span><span class="anchor" id="line-21"></span><p class="line867"><tt class="backtick">-o</tt>    generate brain surface outline overlaid onto original image <span class="anchor" id="line-22"></span><span class="anchor" id="line-23"></span><p class="line867"><tt class="backtick">-m</tt>    generate binary brain mask <span class="anchor" id="line-24"></span><span class="anchor" id="line-25"></span><p class="line867"><tt class="backtick">-s</tt>    generate rough skull image (not as clean as what betsurf generates) <span class="anchor" id="line-26"></span><span class="anchor" id="line-27"></span><p class="line867"><tt class="backtick">-n</tt>    don't generate the default brain image output <span class="anchor" id="line-28"></span><span class="anchor" id="line-29"></span><p class="line867"><tt class="backtick">-f&nbsp;&lt;f&gt;</tt>    fractional intensity threshold (0-&gt;1); default=0.5; smaller values give larger brain outline estimates <span class="anchor" id="line-30"></span><span class="anchor" id="line-31"></span><p class="line867"><tt class="backtick">-g&nbsp;&lt;g&gt;</tt>    vertical gradient in fractional intensity threshold (-1-&gt;1); default=0; positive values give larger brain outline at bottom, smaller at top <span class="anchor" id="line-32"></span><span class="anchor" id="line-33"></span><p class="line867"><tt class="backtick">-r&nbsp;&lt;r&gt;</tt>    head radius (mm not voxels); initial surface sphere is set to half of this <span class="anchor" id="line-34"></span><span class="anchor" id="line-35"></span><p class="line867"><tt class="backtick">-c&nbsp;&lt;&nbsp;x&nbsp;y&nbsp;z&gt;</tt>   centre-of-gravity (voxels not mm) of initial mesh surface. <span class="anchor" id="line-36"></span><span class="anchor" id="line-37"></span><p class="line867"><tt class="backtick">-t</tt>    apply thresholding to segmented brain image and mask <span class="anchor" id="line-38"></span><span class="anchor" id="line-39"></span><p class="line867"><tt class="backtick">-e</tt>    generates brain surface as mesh in .vtk format. <span class="anchor" id="line-40"></span><span class="anchor" id="line-41"></span><p class="line867">
<h2 id="Variations_on_default_bet2_functionality_.28mutually_exclusive_options.29:">Variations on default bet2 functionality (mutually exclusive options):</h2>
<span class="anchor" id="line-42"></span><span class="anchor" id="line-43"></span><p class="line867"><tt class="backtick">-R</tt>    This option runs more "robust" brain centre estimation; it repeatedly calls <tt class="backtick">bet2</tt>, each time using the same input image and the same main options, except that the <tt class="backtick">-c</tt> option (which sets the starting centre of the brain estimation) is set each time to the centre-of-gravity of the previously estimated brain extraction. The primary purpose is to improve the brain extraction when the input data contains a lot of non-brain matter - most likely when there is a lot of neck included in the input image. By iterating in this way the centre-of-gravity should move up each time towards the true centre, resulting in a better final estimate. The iterations stop when the centre-of-gravity stops moving, up to a maximum of 10 iterations. <span class="anchor" id="line-44"></span><span class="anchor" id="line-45"></span><p class="line867"><tt class="backtick">-S</tt>    This attempts to cleanup residual eye and optic nerve voxels which <tt class="backtick">bet2</tt> can sometimes leave behind. This can be useful when running SIENA or SIENAX, for example. Various stages involving standard-space masking, morphpological operations and thresholdings are combined to produce a result which can often give better results than just running bet2. <span class="anchor" id="line-46"></span><span class="anchor" id="line-47"></span><p class="line867"><tt class="backtick">-B</tt>   This attempts to reduce image bias, and residual neck voxels. This can be useful when running SIENA or SIENAX, for example. Various stages involving FAST segmentation-based bias field removal and standard-space masking are combined to produce a result which can often give better results than just running <tt class="backtick">bet2</tt>. <span class="anchor" id="line-48"></span><span class="anchor" id="line-49"></span><p class="line867"><tt class="backtick">-Z</tt>    This can improve the brain extraction if only a few slices are present in the data (i.e., a small field of view in the Z direction). This is achieved by padding the end slices in both directions, copying the end slices several times, running <tt class="backtick">bet2</tt> and then removing the added slices. <span class="anchor" id="line-50"></span><span class="anchor" id="line-51"></span><p class="line867"><tt class="backtick">-F</tt>    This option uses <tt class="backtick">bet2</tt> to determine a brain mask on the basis of the first volume in a 4D data set, and applies this to the whole data set. This is principally intended for use on FMRI data, for example to remove eyeballs. Because it is normally important (in this application) that masking be liberal (ie that there be little risk of cutting out valid brain voxels) the -f threshold is reduced to 0.3, and also the brain mask is "dilated" slightly before being used. <span class="anchor" id="line-52"></span>` <span class="anchor" id="line-53"></span><tt class="backtick">-A</tt>    This runs both <tt class="backtick">bet2</tt> and <tt class="backtick">betsurf</tt> programs in order to get the additional skull and scalp surfaces created by <tt class="backtick">betsurf</tt>. This involves registering to standard space in order to allow <tt class="backtick">betsurf</tt> to find the standard space masks it needs. <span class="anchor" id="line-54"></span><span class="anchor" id="line-55"></span><p class="line867"><tt class="backtick">-A2&nbsp;&lt;T2&gt;</tt>    This is the same as <tt class="backtick">-A</tt> except that a T2 image is also input, to further improve the estimated skull and scalp surfaces. As well as carrying out the standard space registration this also registers the T2 to the T1 input image. <span class="anchor" id="line-56"></span><span class="anchor" id="line-57"></span><p class="line862">The old script <tt class="backtick">betpremask</tt> has been replaced with the <tt class="backtick">-b</tt> option in <tt class="backtick">standard_space_roi</tt>. This uses <tt class="backtick">flirt</tt> to register the input image to a standard space whole-head image; the resulting transform is then inverted and a standard-space brain mask is transformed into the space of the input image, and then applied to this to create the output. <span class="anchor" id="line-58"></span><hr /><p class="line874"> <span class="anchor" id="line-59"></span><span class="anchor" id="betgui"></span> <span class="anchor" id="line-60"></span>
<h1 id="Bet_GUI">Bet GUI</h1>
<span class="anchor" id="line-61"></span><span class="anchor" id="line-62"></span><p class="line867">
<h2 id="Main_Options">Main Options</h2>
<span class="anchor" id="line-63"></span><span class="anchor" id="line-64"></span><p class="line862">First set the <strong>Input image</strong> filename and the <strong>Output image</strong> filename. The output name is also used to generate the filenames for any optional outputs that are turned on in <strong>Advanced options</strong>. <span class="anchor" id="line-65"></span><span class="anchor" id="line-66"></span><p class="line862">Changing <strong>Fractional intensity threshold</strong> from its default value of 0.5 will cause the overall segmented brain to become larger (&lt;0.5) or smaller (&gt;0.5). This threshold must lie between 0 and 1. <span class="anchor" id="line-67"></span><span class="anchor" id="line-68"></span><p class="line862">If you change the options menu from the default setting of <strong>Run standard brain extraction using bet2</strong> then you will get one of the <strong>Variations on default bet2 functionality</strong> described above. <span class="anchor" id="line-69"></span><hr /><p class="line874"> <span class="anchor" id="line-70"></span>
<h2 id="Advanced_Options">Advanced Options</h2>
<span class="anchor" id="line-71"></span><span class="anchor" id="line-72"></span><p class="line862">By default the only output from BET is an image with all non-brain matter removed - this is the <strong>Output brain-extracted image option</strong>. <span class="anchor" id="line-73"></span><span class="anchor" id="line-74"></span><p class="line862">The <strong>Output binary brain mask image</strong> option tells BET to output a binary brain mask (0 outside of the brain and 1 inside). This can then be used in later processing, to mask other images derived from the original. <span class="anchor" id="line-75"></span><span class="anchor" id="line-76"></span><p class="line862">The <strong>Apply thresholding to brain and mask image</strong> option causes BET to apply thresholding to the segmented brain image (and also the brain mask if selected). Thus, inside the estimated brain, some voxels can be "zeroed" after segmentation, if their intensity falls below an automatically estimated threshold. <span class="anchor" id="line-77"></span><span class="anchor" id="line-78"></span><p class="line862">The <strong>Output exterior skull surface image</strong> option tells BET to produce an image which is an estimate of the exterior surface of the skull. All non-skull-surface points are 0 in this image, and skull-surface points are 100. <span class="anchor" id="line-79"></span><span class="anchor" id="line-80"></span><p class="line862">The <strong>Output brain surface overlaid onto original image</strong> option creates an output image which is a copy of the original image, with additionally an outline of the brain's surface drawn on top. <span class="anchor" id="line-81"></span><span class="anchor" id="line-82"></span><p class="line862">Changing <strong>Threshold gradient</strong> from its default value of 0 causes a gradient to be apply to the previous threshold. Thus setting a positive value here causes the primary threshold to be reduced at the bottom of the brain, giving a larger brain estimate there, and a smaller estimate of the brain towards the top of the image. This value must lie between -1 and 1. <span class="anchor" id="line-83"></span><span class="anchor" id="betsurf"></span> <span class="anchor" id="line-84"></span>
<h1 id="betsurf-1">betsurf</h1>
<span class="anchor" id="line-85"></span><span class="anchor" id="line-86"></span><p class="line867"><tt class="backtick">betsurf</tt> is the program that produces the three additional surfaces (inner &amp; outer skull, outer scalp). It can output these surfaces as filled-in binary mask images, surface-only binary mask images and <a class="http" href="http://www.geomview.org/">Geomview</a> OFF mesh format files. <span class="anchor" id="line-87"></span><span class="anchor" id="line-88"></span><p class="line867"><tt class="backtick">betsurf</tt> requires ideally good resolution T1- and T2-weighted input images. It can work only from just a T1 image, but the results will generally not be as good. The images should ideally be better than 2x2x2mm - the smaller the voxel size the better. betsurf requires that bet2 has already been run on the T1 image, with the -e mesh output option for the brain surface. It also requires that the T2 image already be aligned (e.g., using <a href="./FLIRT.html">flirt</a>) to the T1. Finally, it requires that you supply a transformation from the T1 to standard space (e.g., generated by flirt) as it uses standard-space masks in order to constraint some of the mesh fitting. <span class="anchor" id="line-89"></span><span class="anchor" id="line-90"></span><p class="line874">The .vtk and .off Geomview mesh files contain mm co-ordinates. If the image has radiological ordering ( see fslorient ) then the mm co-ordinates are the voxel co-ordinates scaled by the mm voxel sizes. If the image has neurological ordering the y and z co-ordinates are the same as for radiological ordering, but the x co-ordinates will be inverted ( x_mm = ( n - 1 - x ) * x_dim ) where n is the number of voxels in the x-direction, x is the voxel co-ordinate and x_dim is the voxel size in mm. <span class="anchor" id="line-91"></span><span class="anchor" id="line-92"></span><p class="line874">As an example of how to use bet2 and betsurf together, see the -A and -A2 options in the bet script. The -A2 option: <span class="anchor" id="line-93"></span><span class="anchor" id="line-94"></span><p class="line874">Registers the T2 to the T1 image. <span class="anchor" id="line-95"></span>Registers the T1 image to standard space (not to transform the image but just to get the transform matrix itself). <span class="anchor" id="line-96"></span>Runs bet2 to get the initial brain extraction from the T1 image. <span class="anchor" id="line-97"></span>Runs betsurf to get the other head surfaces. <span class="anchor" id="line-98"></span><hr /><p class="line874"> <span class="anchor" id="line-99"></span><a href="./CategoryBET.html">CategoryBET</a> <span class="anchor" id="line-100"></span><span class="anchor" id="bottom"></span></div>
</div>
<hr>
2014-07-08 15:31
</body>
</html>
