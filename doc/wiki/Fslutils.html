<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<title>Fslutils</title>
<link rel="stylesheet" type="text/css" media="all" charset="utf-8" href="fsl/css/common.css">
<link rel="stylesheet" type="text/css" media="screen" charset="utf-8" href="fsl/css/screen.css">
<link rel="stylesheet" type="text/css" media="print" charset="utf-8" href="fsl/css/print.css">
<style type="text/css">
ul.pagetitle{
  display: inline;
  margin: 0;
  padding: 0;
  font-size: 1.5em;
}
li.pagetitle{
  display: inline;
  margin: 0;
}
td.noborder {
  border: 0;
}
</style>
</head>
<body>
<table>
<tr>
<td class="noborder">
<img src="logo.png">
</td>
<td class="noborder">
<ul class="pagetitle">
<li class="pagetitle"><a class="backlink">Fslutils</a>
</ul>
<br><br>
[<a href="FSL.html">FSL</a>]&nbsp;[<a href="TitleIndex.html">TitleIndex</a>]&nbsp;[<a href="WordIndex.html">WordIndex</a>]&nbsp;
</td>
</tr>
</table>
<hr>
<div id="page">
<div dir="ltr" id="content" lang="en"><span class="anchor" id="top"></span>
<span class="anchor" id="line-1"></span><p class="line867"><div class="FslToolContents">
<h1>Contents</h1>
<ol><li>Introduction<div class="contentslist"><div class="table-of-contents"><p class="table-of-contents-heading">Contents<ol><li>
<a href="#Orientation-related_Utilities">Orientation-related Utilities</a><ol><li>
<a href="#Tools">Tools</a></li></ol></li></ol></div></div></li><li><a href="./Fslutils(2f)FAQ.html">FAQ</a></li></ol></div> <span class="anchor" id="line-2"></span><span class="anchor" id="line-3"></span><p class="line874">FSLUTILS is a set of useful command-line utilities which allow the conversion, processing etc. of Analyze and Nifti format data sets. Many of them work on both 3D and 4D data. For each of these programs, type just the program name to get the usage help. <span class="anchor" id="line-4"></span><span class="anchor" id="line-5"></span><p class="line874">The different FSLUTILS programs are: <span class="anchor" id="line-6"></span><span class="anchor" id="line-7"></span><ul><li><p class="line891"><tt class="backtick">fslascii2img&nbsp;</tt> - convert ASCII text file to image file. <span class="anchor" id="line-8"></span><span class="anchor" id="line-9"></span></li><li class="gap"><p class="line891"><tt class="backtick">fsl2ascii</tt> - convert image files to ASCII text file (or files if data is 4D). <span class="anchor" id="line-10"></span><span class="anchor" id="line-11"></span></li><li class="gap"><p class="line891"><tt class="backtick">fslcc</tt> - run cross-correlations between every volume in one 4D data set with every volume in another (for investigating similarities in ICA outputs). <span class="anchor" id="line-12"></span><span class="anchor" id="line-13"></span></li><li class="gap"><p class="line891"><tt class="backtick">fslchfiletype</tt> - used to change the file type of an image (e.g. from ANALYZE_GZ to NIFTI). The first argument is the desired file type (one of ANALYZE, ANALYZE_GZ, NIFTI, NIFTI_GZ, NIFTI_PAIR, NIFTI_PAIR_GZ) and the second is the input file. If no third argument is given then the input file is converted in place. This in place conversion removes the original files: e.g. for an Analyze file called stdimg then <tt class="backtick">fslchfiletype&nbsp;NIFTI_GZ&nbsp;stdimg</tt> would replace stdimg.hdr and stdimg.img with stdimg.nii.gz. Note that having multiple copies of an image with the same basename and different filetypes (e.g. stdimg.nii.gz and stdimg.hdr and stdimg.img) creates many problems for determining what images to read, and in general will cause FSL programs to stop. <span class="anchor" id="line-14"></span><span class="anchor" id="line-15"></span></li><li class="gap"><p class="line891"><tt class="backtick">fslcomplex</tt> - a utility that allows 3D or 4D complex image files to be split or constructed from corresponding real components (either Cartesian or polar). The initial flag indicates what kind of processing is done. In addition, two optional arguments at the end specify the first and last 3D volumes to be processed when the input is 4D (default is to do all volumes). <span class="anchor" id="line-16"></span><span class="anchor" id="line-17"></span></li><li class="gap"><p class="line891"><tt class="backtick">fslcpgeom</tt> - copy certain parts of the header information (image dimensions, voxel dimensions, voxel dimensions units string, image orientation/origin or qform/sform info) from one image to another. Note that only copies from Analyze to Analyze or Nifti to Nifti will work properly. Copying from different files will result in loss of information or potentially incorrect settings. <span class="anchor" id="line-18"></span><span class="anchor" id="line-19"></span></li><li class="gap"><p class="line891"><tt class="backtick">fslcreatehd</tt> - creates a new image header along with a zero intensity data image. There are two forms of input: one takes a list of minimal information on the command line, the other takes in an xml-style file, as written by <tt class="backtick">fslhd&nbsp;-x</tt>. The information required in the first version is: x/y/z/tsize for image dimensions, x/y/zvoxsize for voxel dimensions (eg in mm), tr in seconds for time between volumes (for 3D data set to 0), x/y/zorigin for voxel co-ordinate origin (eg for standard space - otherwise leave as 0 0 0), datatype for the voxel data type (the commonest are: 1=binary, 2=unsigned char, 4=signed short, 8=signed int, 16=float). Note that this is <em>different</em> from the previous versions in that an entire image is created, and will <em>overwrite</em> any <tt class="backtick">.img</tt> file contents of the same image name. <span class="anchor" id="line-20"></span><span class="anchor" id="line-21"></span></li><li class="gap"><p class="line891"><tt class="backtick">fsledithd</tt> - allows the header information in and image to be edited in a text-based xml-style format (like the output of <tt class="backtick">fslhd&nbsp;-x</tt> but with redundant fields removed and some help text provided). Note that the default text editor used is nano, but other editors can be specified by the second argument. <span class="anchor" id="line-22"></span><span class="anchor" id="line-23"></span></li><li class="gap"><p class="line891"><tt class="backtick">fslfft</tt> - outputs the Fast-Fourier Transform (or inverse) for a complex input volume. <span class="anchor" id="line-24"></span><span class="anchor" id="line-25"></span></li><li class="gap"><p class="line891"><tt class="backtick">fslhd</tt> - report every field of an Analyze or Nifti header (note that the fields are different although some are common, e.g. pixdims). The option "-x" produces an xml-style output which can be used in conjunction with <tt class="backtick">fslcreatehd</tt>. The reported values are those used internally in FSL programs and are sometimes different from the raw values stored in the file to avoid incorrect settings (e.g. dimN has a minimum value of 1, not 0). <span class="anchor" id="line-26"></span><span class="anchor" id="line-27"></span></li><li class="gap"><p class="line891"><tt class="backtick">fslinfo</tt> - report a basic subset of an Analyze or Nifti header. <span class="anchor" id="line-28"></span><span class="anchor" id="line-29"></span></li><li class="gap"><p class="line891"><tt class="backtick">fslinterleave</tt> - interleave two inputs to form a combined image. <span class="anchor" id="line-30"></span><span class="anchor" id="line-31"></span></li><li class="gap"><p class="line891"><tt class="backtick">fslmaths</tt> - simple but powerful program to allow mathematical manipulation of images. Now includes spatial and temporal filtering, statistic conversion (e.g. z to p-values), diffusion tensor decomposition, and TFCE calculation. <span class="anchor" id="line-32"></span><span class="anchor" id="line-33"></span></li><li class="gap"><p class="line891"><tt class="backtick">fslmeants</tt> - output the average timeseries of a set of voxels, or the individual time series for each of these voxels. <span class="anchor" id="line-34"></span><span class="anchor" id="line-35"></span></li><li class="gap"><p class="line891"><tt class="backtick">fslmerge</tt> - concatenate image files into a single output. This concatenation can be in time, or in X, Y or Z. All image dimensions (except for the one being concatenated over) must be the same in all input images. For example, this can be used to take multiple 3D files (eg as output by SPM) and create a single 4D image file. <span class="anchor" id="line-36"></span><span class="anchor" id="line-37"></span></li><li class="gap"><p class="line891"><tt class="backtick">fslnvols</tt> - report how many time points are in the input 4D data set. <span class="anchor" id="line-38"></span><span class="anchor" id="line-39"></span></li><li class="gap"><p class="line891"><tt class="backtick">fslpspec</tt> - outputs the spectral power density of an input 4D data set. <span class="anchor" id="line-40"></span><span class="anchor" id="line-41"></span></li><li class="gap"><p class="line891"><tt class="backtick">fslroi</tt> - extract region of interest (ROI) from an image. You can a) take a 3D ROI from a 3D data set (or if it is 4D, the same ROI is taken from each time point and a new 4D data set is created), b) extract just some time points from a 4D data set, or c) control time and space limits to the ROI. Note that the arguments are minimum index and size (not maximum index). So to extract voxels 10 to 12 inclusive you would specify 10 and 3 (not 10 and 12). <span class="anchor" id="line-42"></span><span class="anchor" id="line-43"></span></li><li class="gap"><p class="line891"><tt class="backtick">fslslice</tt> - split a 3D file into lots of 2D files (along z-axis). <span class="anchor" id="line-44"></span><span class="anchor" id="line-45"></span></li><li class="gap"><p class="line891"><tt class="backtick">fslsplit</tt> - split a 4D file into lots of 3D files (eg for inputting to SPM). <span class="anchor" id="line-46"></span><span class="anchor" id="line-47"></span></li><li class="gap"><p class="line891"><tt class="backtick">fslstats</tt> - report certain summary statistics for an input 3D/4D image. Of particular value is the "robust intensity range" which calculates values similar to the 2% and 98% percentiles, but ensuring that the majority of the intensity range is captured, even for binary images. In addition, it can take an aribitrary mask as input (values need to be greater than 0.5 to be part of the mask) so that statistics are only calculated within the mask and can also generate histogram data. <span class="anchor" id="line-48"></span><span class="anchor" id="line-49"></span></li><li class="gap"><p class="line891"><tt class="backtick">fslval</tt> - report a particular parameter (given a particular keyword eg "dim4") from an image header. To see the list of keywords run <tt class="backtick">fslhd</tt> on the header and look at the first column. <span class="anchor" id="line-50"></span><span class="anchor" id="line-51"></span></li></ul><p class="line867">
<h1 id="Orientation-related_Utilities">Orientation-related Utilities</h1>
<span class="anchor" id="line-52"></span><p class="line862">Please see <a href="./Orientation(20)Explained.html">Orientation Explained</a> for an explanation (both simple and also detailed) of how orientation works with NIfTI files and FSL.  You should <strong>never</strong> use the tools below until you have read this page on orientation. <span class="anchor" id="line-53"></span><span class="anchor" id="line-54"></span><p class="line867">
<h2 id="Tools">Tools</h2>
<span class="anchor" id="line-55"></span><ul><li><p class="line891"><tt class="backtick">fslreorient2std</tt> - this is a simple tool designed to reorient an image to match the orientation of the standard template images (MNI152) so that they appear "the same way around" in FSLView. It requires that the image labels are correct in FSLView before this is run. It is also not a registration tool, so it will not align the image to standard space, it will only apply 90, 180 or 270 degree rotations about the different axes as necessary to get the labels in the same position as the standard template. <span class="anchor" id="line-56"></span><span class="anchor" id="line-57"></span></li><li class="gap"><p class="line891"><tt class="backtick">fslorient</tt> - this is an advanced tool that reports or sets the orientation information in a file. Note that only in NIfTI files can the orientation be changed - Analyze files are <em>always treated as "radiological"</em> (meaning that they could be simply rotated into the same alignment as the MNI152 standard images - equivalent to the appropriate <em>sform</em> or <em>qform</em> in a NIfTI file having a negative determinant). <span class="anchor" id="line-58"></span><span class="anchor" id="line-59"></span></li></ul><p class="line862">In nifti files it is possible to independently report or modify the <em>qform</em> or <em>sform</em> fields (see below for background information on NIfTI orientation). However, the FSL4.1 output routines will try to keep <em>qform and sform matrices the same</em> whenever one would otherwise be unset. Therefore it is not possible, for instance, to delete only the qform, as if the sform is set then doing this will result in the qform being set equal (as close as possible) to the sform. This is currently done to aid interoperability with other packages. However, if both qform and sform are given different values then these are preserved by the output routines. <span class="anchor" id="line-60"></span><span class="anchor" id="line-61"></span><p class="line874">This command does not change the data storage at all - only the orientation information in the header and so should be used with great caution. Only modify header information if you understand the information about the NIfTI orientation given below or are following (exactly) a set of steps prescribed by someone who does. <span class="anchor" id="line-62"></span><span class="anchor" id="line-63"></span><p class="line862">The option <tt class="backtick">-deleteorient</tt> is useful for the first stage of correcting orientation/label information in images where the conversion to NIfTI does not provide the correction information. Note that the first, and by far the best, solution to this problem is to find a method of converting the images to NIfTI in a way that correctly stores the information (see above) but if this really is not possible then a combination of <tt class="backtick">fslorient</tt> and <tt class="backtick">fslswapdim</tt> can be used to fix it (see below). <span class="anchor" id="line-64"></span><span class="anchor" id="line-65"></span><ul><li><p class="line891"><tt class="backtick">fslswapdim</tt> - this is an advanced tool that re-orders the data storage to permit changes between axial, sagittal and coronal slicing. When used in this mode the same left-right convention (also called coordinate handedness or radiological/neurological convention) will be maintained as long <em>as no warning is printed</em>. <span class="anchor" id="line-66"></span><span class="anchor" id="line-67"></span></li></ul><p class="line862">The new orientation of the data is specified by selecting what the new axes should represent. This can either be done in terms of the old axes (x y z -x -y -z) or in terms of anatomical labels <em>when this information is available</em> (in a nifti image where either the sform or qform code is non-zero). The anatomical labels are RL LR AP PA SI IS. Note that the anatomical label version will not allow the left-right convention to be changed. <span class="anchor" id="line-68"></span><span class="anchor" id="line-69"></span><p class="line862">Ordinarily <tt class="backtick">fslswapdim</tt> will change the orientation information in the header as well as reordering the data. This is so that the anatomical labels stay attached to the same parts of the image and not fixed to the voxel coordinates. Hence, reordering a coronal image to axial slicing should keep the labels correctly attached to the relevant parts of the image, as long as they were correct initially. If the initial labels are incorrect (see the labels in <tt class="backtick">fslview</tt>) then <tt class="backtick">fslorient</tt> needs to be used in conjunction with <tt class="backtick">fslswapdim</tt> in order to correct this. <span class="anchor" id="line-70"></span><span class="anchor" id="line-71"></span><p class="line862">When <tt class="backtick">fslswapdim</tt> is given arguments that will change the left-right orientation it will issue a warning that the left-right orientation is being flipped. It will also try to modify the orientation information in the header (only when either the sform or qform code is non-zero), but not in a way that swaps this left-right orientation in the header. Hence there is a net change in orientation as the data is swapped while the header is not. If the swap occurs on the x-axis then nothing is done to the header at all. Otherwise, the axis which is being swapped, together with the x-axis, have their orientation changed. In this way the handedness of the header is preserved, the labels associated with the y-axis and z-axis follow the image change, but the x-axis labels do not. It is recommended that if a left-right swap in storage is desired (and this should only be done if the reconstruction is initially incorrect, and cannot be fixed by finding any better conversion method) then the arguments <tt class="backtick">-x&nbsp;y&nbsp;z</tt> should be used as this is the simplest form of swapping since it only affects the x-axis data and no labels or header information is changed. <span class="anchor" id="line-72"></span><span class="anchor" id="line-73"></span><p class="line867"><hr /><p class="line874"> <span class="anchor" id="line-74"></span><a href="./CategoryOther.html">CategoryOther</a> <a href="./CategoryFslutils.html">CategoryFslutils</a> <span class="anchor" id="line-75"></span><span class="anchor" id="bottom"></span></div>
</div>
<hr>
2014-07-08 15:34
</body>
</html>
