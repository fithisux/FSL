<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<title>MELODIC</title>
<link rel="stylesheet" type="text/css" media="all" charset="utf-8" href="fsl/css/common.css">
<link rel="stylesheet" type="text/css" media="screen" charset="utf-8" href="fsl/css/screen.css">
<link rel="stylesheet" type="text/css" media="print" charset="utf-8" href="fsl/css/print.css">
<style type="text/css">
ul.pagetitle{
  display: inline;
  margin: 0;
  padding: 0;
  font-size: 1.5em;
}
li.pagetitle{
  display: inline;
  margin: 0;
}
td.noborder {
  border: 0;
}
</style>
</head>
<body>
<table>
<tr>
<td class="noborder">
<img src="logo.png">
</td>
<td class="noborder">
<ul class="pagetitle">
<li class="pagetitle"><a class="backlink">MELODIC</a>
</ul>
<br><br>
[<a href="FSL.html">FSL</a>]&nbsp;[<a href="TitleIndex.html">TitleIndex</a>]&nbsp;[<a href="WordIndex.html">WordIndex</a>]&nbsp;
</td>
</tr>
</table>
<hr>
<div id="page">
<div dir="ltr" id="content" lang="en"><span class="anchor" id="top"></span>
<span class="anchor" id="line-1"></span><p class="line867"><div class="FslToolContents">
<h1>Contents</h1>
<ol><li>Introduction<div class="contentslist"><div class="table-of-contents"><p class="table-of-contents-heading">Contents<ol><li>
<a href="#Research_Overview">Research Overview</a></li><li>
<a href="#Melodic_GUI">Melodic GUI</a><ol><li>
<a href="#GUI_details:">GUI details:</a></li><li>
<a href="#Misc">Misc</a></li><li>
<a href="#Data">Data</a></li><li>
<a href="#Pre-Stats">Pre-Stats</a></li><li>
<a href="#Registration">Registration</a></li><li>
<a href="#Stats">Stats</a></li><li>
<a href="#Post-Stats">Post-Stats</a></li><li>
<a href="#Bottom_Row_of_Buttons">Bottom Row of Buttons</a></li><li>
<a href="#MELODIC_report_output">MELODIC report output</a></li></ol></li><li>
<a href="#melodic_command-line_program">melodic command-line program</a></li><li>
<a href="#fsl_regfilt_command-line_program">fsl_regfilt command-line program</a></li><li>
<a href="#Using_melodic_for_just_doing_mixture-modelling">Using melodic for just doing mixture-modelling</a></li></ol></div></div></li><li><a href="./MELODIC(2f)FAQ.html">FAQ</a></li></ol></div> <span class="anchor" id="line-2"></span><span class="anchor" id="line-3"></span><p class="line867"><img alt="tica diagram" class="attachment" src="attachments/MELODIC/tica_diag.png" title="tica diagram" /> <span class="anchor" id="line-4"></span><span class="anchor" id="line-5"></span><p class="line867">
<h1 id="Research_Overview">Research Overview</h1>
<span class="anchor" id="line-6"></span><span class="anchor" id="line-7"></span><p class="line874">MELODIC ( Multivariate Exploratory Linear Optimized Decomposition into Independent Components ) 3.0 uses Independent Component Analysis to decompose a single or multiple 4D data sets into different spatial and temporal components. For ICA group analysis, MELODIC uses either Tensorial Independent Component Analysis (TICA, where data is decomposed into spatial maps, time courses and subject/session modes) or a simpler temporal concatenation approach. MELODIC can pick out different activation and artefactual components without any explicit time series model being specified. <span class="anchor" id="line-8"></span><span class="anchor" id="line-9"></span><span class="anchor" id="line-10"></span><p class="line862">A paper on MELODIC Probabilistic ICA (PICA) has been published in IEEE TMI. For detail, see a technical report on MELODIC <a class="http" href="http://www.fmrib.ox.ac.uk/analysis/techrep/tr02cb1/tr02cb1.pdf">PDF</a>.  <span class="anchor" id="line-11"></span><span class="anchor" id="line-12"></span><p class="line862">A paper on Tensor ICA for multi-session and multi-subject analysis has been published in NeuroImage. For detail, see a technical report on TICA <a class="http" href="http://www.fmrib.ox.ac.uk/analysis/techrep/tr04cb1/tr04cb1.pdf">PDF</a>.  <span class="anchor" id="line-13"></span><span class="anchor" id="line-14"></span><p class="line862">A paper investigating resting-state connectivity using independent component analysis has been published in Philosophical Transactions of the Royal Society. For detail, see a technical report <a class="http" href="http://www.fmrib.ox.ac.uk/analysis/techrep/tr05cb1/tr05cb1.pdf">PDF</a>. <span class="anchor" id="line-15"></span><span class="anchor" id="line-16"></span><p class="line874">The different MELODIC programs are: <span class="anchor" id="line-17"></span><span class="anchor" id="line-18"></span><ul><li><p class="line891"><a href="./MELODIC.html#Melodic">Melodic</a> - MELODIC GUI <span class="anchor" id="line-19"></span></li><li><p class="line891"><a href="./MELODIC.html#melodic">melodic</a> - command-line MELODIC program <span class="anchor" id="line-20"></span></li><li><p class="line891"><a href="./MELODIC.html#fsl_regfilt">fsl_regfilt</a> - command-line tool for removing regressors from data (melodic denoising) <span class="anchor" id="line-21"></span></li></ul><p class="line867"><hr /><p class="line874"> <span class="anchor" id="line-22"></span><span class="anchor" id="Melodic"></span> <span class="anchor" id="line-23"></span>
<h1 id="Melodic_GUI">Melodic GUI</h1>
<span class="anchor" id="line-24"></span><p class="line867"><img align="right" alt="MELODIC GUI" class="attachment" src="attachments/MELODIC/gui.png" title="MELODIC GUI" /> <span class="anchor" id="line-25"></span><span class="anchor" id="line-26"></span><p class="line862">To call the MELODIC GUI, either type <tt class="backtick">Melodic</tt> in a terminal (type <tt class="backtick">Melodic_gui</tt> on Mac), or run <tt class="backtick">fsl</tt> and press the <strong>MELODIC</strong> button. <span class="anchor" id="line-27"></span><span class="anchor" id="line-28"></span><p class="line862">Before calling the GUI, you need to prepare each session's data as a 4D NIFTI or Analyze format image; there are utilities in fsl/bin called <a href="./FslUtils.html">fslmerge and fslsplit</a> to convert between multiple 3D images and a single 4D (3D+time) image. <span class="anchor" id="line-29"></span><span class="anchor" id="line-30"></span><p class="line862">Structural images for use as "highres" images in registration should normally be brain-extracted using <a href="./BET.html">BET</a>. <span class="anchor" id="line-31"></span><span class="anchor" id="line-32"></span><p class="line867">
<h2 id="GUI_details:">GUI details:</h2>
<span class="anchor" id="line-33"></span><span class="anchor" id="line-34"></span><ul><li><p class="line891"><a href="./MELODIC.html#Misc">Misc</a> <span class="anchor" id="line-35"></span></li><li><p class="line891"><a href="./MELODIC.html#Data">Data</a> <span class="anchor" id="line-36"></span></li><li><p class="line891"><a href="./MELODIC.html#Pre-Stats">Pre-Stats</a> <span class="anchor" id="line-37"></span></li><li><p class="line891"><a href="./MELODIC.html#Registration">Registration</a> <span class="anchor" id="line-38"></span></li><li><p class="line891"><a href="./MELODIC.html#Stats">Stats</a> <span class="anchor" id="line-39"></span></li><li><p class="line891"><a href="./MELODIC.html#Post-Stats">Post-Stats</a> <span class="anchor" id="line-40"></span></li><li><p class="line891"><a href="./MELODIC.html#Bottom_Row_of_Buttons">Bottom Row of Buttons</a> <span class="anchor" id="line-41"></span></li><li><p class="line891"><a href="./MELODIC.html#MELODIC_report_output">MELODIC report output</a> <span class="anchor" id="line-42"></span><span class="anchor" id="line-43"></span></li></ul><p class="line867"><hr /><p class="line874"> <span class="anchor" id="line-44"></span>
<h2 id="Misc">Misc</h2>
<span class="anchor" id="line-45"></span><span class="anchor" id="line-46"></span><p class="line867"><strong>Balloon help</strong> (the popup help messages in the MELODIC GUI) can be turned off once you are familiar with the GUI. <span class="anchor" id="line-47"></span><span class="anchor" id="line-48"></span><p class="line862">The <strong>Progress watcher</strong> button allows you to tell Melodic not to start a web browser to watch the analysis progress. If you are running lots of analyses you probably want to turn this off; you can view the same logging information by looking at the report_log.html or log.txt files in any MELODIC directories instead. <span class="anchor" id="line-49"></span>--- <span class="anchor" id="line-50"></span>
<h2 id="Data">Data</h2>
<span class="anchor" id="line-51"></span><span class="anchor" id="line-52"></span><p class="line862">First, set the filename of the 4D input image (e.g. <tt class="backtick">/users/sibelius/origfunc.nii.gz</tt>) by pressing <strong>Select 4D data</strong>. You can select multiple files if you want MELODIC to perform a group analysis or if you want to run separate ICAs with the same setup. Results for each input file will be saved in separate .ica directories, the name of which is based on the input data's filename (unless you enter an <strong>Output directory</strong> name). <span class="anchor" id="line-53"></span><span class="anchor" id="line-54"></span><p class="line867"><strong>Delete volumes</strong> controls the number of initial FMRI volumes to delete before any further processing. <span class="anchor" id="line-55"></span><span class="anchor" id="line-56"></span><p class="line867"><strong>TR</strong> controls the time (in seconds) between scanning successive FMRI volumes. Changes here will not affect the analysis and only change the x-axis units of the final time series plots. <span class="anchor" id="line-57"></span><span class="anchor" id="line-58"></span><p class="line862">The <strong>High pass filter cutoff</strong> controls the longest temporal period that you will allow. <span class="anchor" id="line-59"></span><hr /><p class="line874"> <span class="anchor" id="line-60"></span>
<h2 id="Pre-Stats">Pre-Stats</h2>
<span class="anchor" id="line-61"></span><span class="anchor" id="line-62"></span><p class="line862">Low-frequency drifts and motion in the data can adversely affect the decomposition. In most cases, you would want to motion-correct the data, remove these drifts first or perform other types of typical data pre-processing before running the analysis. This can be done from within the Melodic GUI <strong>Pre-stats</strong> section. <span class="anchor" id="line-63"></span><hr /><p class="line874"> <span class="anchor" id="line-64"></span>
<h2 id="Registration">Registration</h2>
<span class="anchor" id="line-65"></span><span class="anchor" id="line-66"></span><p class="line874">Before any multi-session or multi-subject analyses can be carried out, the different sessions need to be registered to each other. This is made easy within MELODIC which performs registration on input data as part of an analysis using FEAT functionality. Unlike registration step in FEAT this here needs to be performed before the statistical analysis so that the filtered functional data is transformed into the standard space. For information on using multi-stage registration please consult the FEAT manual. <span class="anchor" id="line-67"></span><span class="anchor" id="line-68"></span><p class="line867"><strong>Standard space</strong> refers to the standard (reference) image; it should be an image already in standard space, ideally with the non-brain structures already removed. <span class="anchor" id="line-69"></span><span class="anchor" id="line-70"></span><p class="line867"><strong>Resampling resolution (mm)</strong> refers to the desired isotropic voxel dimension of the resampled data. In order to save on disk space and on required memory during the analysis it is advisable to resample the filtered data into standard space but keeping the resampled resolution at the FMRI resolution (typically 4mm or 5mm).   <span class="anchor" id="line-71"></span><span class="anchor" id="line-72"></span><p class="line874">Note that any output image can be transformed to a higher resolution space later on - see <span class="anchor" id="line-73"></span><a class="https" href="https://fsl.fmrib.ox.ac.uk/fsl/fslwiki/MELODIC/FAQ#How_do_I_transform_the_MELODIC_results_from_a_low-resolution_space_to_a_higher-resolution_one.3F">FAQ</a> <span class="anchor" id="line-74"></span><hr /><p class="line874"> <span class="anchor" id="line-75"></span>
<h2 id="Stats">Stats</h2>
<span class="anchor" id="line-76"></span><span class="anchor" id="line-77"></span><p class="line874">The Stats section lets you control some of the options for the decomposition. The default setting will most probably already be set to what you would want most of the time. <span class="anchor" id="line-78"></span><span class="anchor" id="line-79"></span><p class="line874">By default, MELODIC will variance-normalise timecourses. <span class="anchor" id="line-80"></span><span class="anchor" id="line-81"></span><p class="line874">By default, Melodic will automatically estimate the number of components from the data - you can switch this option off and then can specify the number of components explicitly. <span class="anchor" id="line-82"></span><span class="anchor" id="line-83"></span><p class="line874">You can now select the type of analysis. MELODIC currently offers three options: <span class="anchor" id="line-84"></span><span class="anchor" id="line-85"></span><p class="line867"><img align="right" alt="single diagram" class="attachment" src="attachments/MELODIC/pica_diag.png" title="single diagram" /> <span class="anchor" id="line-86"></span><ul><li><p class="line891"><strong>Single-session ICA</strong>: This will perform standard 2D ICA on each of the input files. The input data will each be represented as a 2D time x space matrix. MELODIC then de-composes each matrix separately into pairs of time courses and spatial maps. The original data is assumed to be the sum of outer products of time courses and spatial maps. All the different time courses (one per component) will be saved in the mixing matrix melodic_mix and all the spatial maps (one per component) will be saved in the 4D file melodic_IC. <span class="anchor" id="line-87"></span></li></ul><p class="line874">When using separate analyses, MELODIC will attempt to find components which are relevant and non-Gaussian relative to the residual fixed-effects within session/subject variation. It is recommended to use this option in order to check for session-specific effects (such as MR artefacts). You will need to use this option if you want to perform MELODIC denoising using fsl_regfilt. When using single-session ICA the component are ordered in order of decreasing amounts of uniquely explained variance. <span class="anchor" id="line-88"></span><span class="anchor" id="line-89"></span><p class="line867"><img align="right" alt="concatenation diagram" class="attachment" src="attachments/MELODIC/concat_diag.png" title="concatenation diagram" /> <span class="anchor" id="line-90"></span><ul><li><p class="line891"><strong>Multi-session temporal concatenation</strong>: This will perform a single 2D ICA run on the concatenated data matrix (obtained by stacking all 2D data matrices of every single data set on top of each other). <span class="anchor" id="line-91"></span></li></ul><p class="line874">It is recommended to use this approach in cases where one is looking for common spatial patterns but can not assume that the associated temporal response is consistent between sessions/subjects. Examples include activation studies where the design was randomised between sessions or the analysis of data acquired without stimulation (resting-state FMRI). <span class="anchor" id="line-92"></span><span class="anchor" id="line-93"></span><p class="line874">This approach does not assume that the temporal response pattern is the same across the population, though the final web report will contain the first Eigenvector of all different temporal responses as a summary time course. Access to all time courses is available: the time series plot is linked to a text file (tXX.txt) which contains the first Eigenvector, the best model fit in case a time series design was specified and all different subject/session-specific time courses as columns. For each component the final mixing matrix melodic_mix contains the temporal response of all different data sets concatenated into a single column vector. The final reported time course will be the best rank-1 approximation to these different responses.  <span class="anchor" id="line-94"></span><span class="anchor" id="line-95"></span><p class="line867"><img align="right" alt="tica diagram" class="attachment" src="attachments/MELODIC/tica_diag.png" title="tica diagram" /> <span class="anchor" id="line-96"></span><ul><li><p class="line891"><strong>Multi-session Tensor-ICA</strong>: This will perform a 3D Tensor-ICA decomposition of the data. All individual data sets will be represented as a single time x space x sessions/subjects block of data. Tensor-ICA will decompose this block of data into triplets of time courses, spatial maps and session/subject modes, which - for each component - characterise the signal variation across the temporal, spatial and subject/session domain. <span class="anchor" id="line-97"></span></li></ul><p class="line874">It is recommended to use this approach for data where the stimulus paradigm is consistent between session/subjects. Tensor-ICA assumes that the temporal response pattern is the same across the population and provides a single decomposition for all original data sets. MELODIC will attempt to find components which are highly non-Gaussian relative to the full mixed-effects variance of the residuals. <span class="anchor" id="line-98"></span><span class="anchor" id="line-99"></span><p class="line862">Estimated components typically fall into 2 classes: components which describe effects common to all or most subjects/sessions, and components which describe effects only contained in a small number of subjects/sessions. The former will have a non-zero estimated effect size while the latter will have an effect size around 0 for most subjects/sessions and only few high non-zero values. These different types of components can be identified easily by looking at the boxplots provided. When using Tensor-ICA the components are ordered in order of decreasing amount of median response amplitude. For details on the decomposition see the technical report <a class="http" href="http://www.fmrib.ox.ac.uk/analysis/techrep/">TR04CB1</a>. <span class="anchor" id="line-100"></span><span class="anchor" id="line-101"></span><span class="anchor" id="line-102"></span><p class="line867"><hr /><p class="line874"> <span class="anchor" id="line-103"></span>
<h2 id="Post-Stats">Post-Stats</h2>
<span class="anchor" id="line-104"></span><span class="anchor" id="line-105"></span><p class="line874">Melodic will also by default carry out inference on the estimated maps using a mixture model and an alternative hypothesis testing approach. A threshold level of 0.5 in the case of alternative hypothesis testing means that a voxel 'survives' thresholding as soon as the probability of being in the 'active' class (as modelled by the Gamma densities) exceeds the probability of being in the 'background' noise class. This threshold level assumes that you are placing an equal loss on false-positives and false-negatives. If, however, you consider e.g. false-positives as being twice as bad as false-negatives you should change this value to 0.66... <span class="anchor" id="line-106"></span><span class="anchor" id="line-107"></span><p class="line874">You can select the background image used for the generation of the spatial map overlay images. <span class="anchor" id="line-108"></span><span class="anchor" id="line-109"></span><p class="line874">If you select the Output full stats folder option, MELODIC will save thresholded maps and probability maps in a /stats subdirectory within its output folder. <span class="anchor" id="line-110"></span><span class="anchor" id="line-111"></span><p class="line862">You can specify a temporal design matrix (and in the case of a group analysis also, a session/subject design matrix) as well as corresponding contrast matrices. If these matrices are set in the GUI, MELODIC will perform a post-hoc regression analysis on estimated time courses and session/subject modes. This can be a helpful tool in order to identify whether or not a given component is task related. The matrices themselves can be created easily using the <a class="nonexistent" href="./FEAT(2f)Guide.html#FEAT_Programs">Glm</a> GUI. <span class="anchor" id="line-112"></span><hr /><p class="line874"> <span class="anchor" id="line-113"></span>
<h2 id="Bottom_Row_of_Buttons">Bottom Row of Buttons</h2>
<span class="anchor" id="line-114"></span><span class="anchor" id="line-115"></span><p class="line862">When you have finished setting up MELODIC, press <strong>Go</strong> to run the analysis. Once MELODIC is running, you can either <strong>Exit</strong> the GUI, or setup further analyses. <span class="anchor" id="line-116"></span><span class="anchor" id="line-117"></span><p class="line862">The <strong>Save</strong> and <strong>Load</strong> buttons enable you to save and load the complete MELODIC setup to and from file. <span class="anchor" id="line-118"></span><hr /><p class="line874"> <span class="anchor" id="line-119"></span>
<h2 id="MELODIC_report_output">MELODIC report output</h2>
<span class="anchor" id="line-120"></span><span class="anchor" id="line-121"></span><p class="line874">Melodic will then generate the results and your terminal window will tell you where to find the web report. Each IC_XX.html webpage shows one spatial map thresholded and rendered on top of a background image followed by the relevant time-course of the ICA decomposition and the power-spectrum of the time-course. <span class="anchor" id="line-122"></span>If you click on the thresholded map, you can inspect the raw IC output together with probability maps and the Mixture Model fit. <span class="anchor" id="line-123"></span><span class="anchor" id="line-124"></span><p class="line874">In the case of TICA or simple time series concatenation the time course plotted is the rank-1 approximation to all the different time courses that correspond to the given spatial map within the population. <span class="anchor" id="line-125"></span><span class="anchor" id="line-126"></span><p class="line862">If a temporal design was specified in the <a href="./MELODIC.html#Post-Stats">Post-Stats</a> section then the time series plot will also contain a plot of the total model fit. In addition, a simple GLM table will describe the fit in detail, providing information of the regression parameter estimates (PEs). Furthermore, MELODIC will perform a simple F-test on the estimated time course and the total model fit. For task-related components the model fit will explain large amounts of the variation contained in the estimated time couse. In addition, if a contrast matrix was specified, the table will also contain Z-statistics and p-values for all the contrasts. If a group analysis was carried out then the report page will also include information on the distribution of the effect size across the population. A simple plot and a boxplot show the relative effect size across the different sessions/subjects. If a design matrix was specified in the GUI setup then MELODIC will also include a GLM regression fit table. <span class="anchor" id="line-127"></span><span class="anchor" id="melodic"></span> <span class="anchor" id="line-128"></span><hr /><p class="line874"> <span class="anchor" id="line-129"></span>
<h1 id="melodic_command-line_program">melodic command-line program</h1>
<span class="anchor" id="line-130"></span><span class="anchor" id="line-131"></span><p class="line867"><tt class="backtick">Type&nbsp;melodic&nbsp;--help&nbsp;to&nbsp;get&nbsp;usage.</tt> <span class="anchor" id="line-132"></span><span class="anchor" id="fsl_regfilt"></span> <span class="anchor" id="line-133"></span><hr /><p class="line874"> <span class="anchor" id="line-134"></span>
<h1 id="fsl_regfilt_command-line_program">fsl_regfilt command-line program</h1>
<span class="anchor" id="line-135"></span><span class="anchor" id="line-136"></span><p class="line874">Running MELODIC can be a useful tool for gaining insight into unexpected artefacts or activation in your data. <span class="anchor" id="line-137"></span><span class="anchor" id="line-138"></span><p class="line874">As well as being a good way to find structured noise (or unexpected activation) in your data, ICA can also be used to remove chosen components (normally obvious scanner-related or physiological artefacts) from your data in order, for example, in order to improve the FEAT results. In order to do this: <span class="anchor" id="line-139"></span><span class="anchor" id="line-140"></span><ul><li>Run MELODIC single-session ICA on a 4D image file <span class="anchor" id="line-141"></span></li><li><p class="line862">Open the MELODIC report (<tt class="backtick">melodic_output_directory.ica/filtered_func_data.ica/report/00index.html</tt>) in a web browser and look through the components to identify those that you wish to remove; record the list of component numbers to remove. <span class="anchor" id="line-142"></span></li><li>In a terminal, run the MELODIC denoising, using the commands: <span class="anchor" id="line-143"></span><ul><li style="list-style-type:none"><p class="line891"><tt class="backtick">cd&nbsp;melodic_output_directory.ica</tt> <span class="anchor" id="line-144"></span></li><li style="list-style-type:none"><p class="line891"><tt class="backtick">fsl_regfilt&nbsp;-i&nbsp;filtered_func_data&nbsp;-o&nbsp;denoised_data&nbsp;-d&nbsp;filtered_func_data.ica/melodic_mix&nbsp;-f&nbsp;"2,5,9"</tt> <span class="anchor" id="line-145"></span></li><li style="list-style-type:none">where you should replace the comma-separated list of component numbers with the list that you previously recorded when viewing the MELODIC report. <span class="anchor" id="line-146"></span><span class="anchor" id="line-147"></span></li></ul></li></ul><p class="line862">The output file <tt class="backtick">denoised_data.nii.gz</tt> then contains the filtered and denoised data set which can be used e.g. within FEAT. When running FEAT on this data make sure that the analysis is set to <strong>Stats + Post-stats</strong> as you do not want to run the other filtering steps (smoothing etc.) again on this data. Similarly, when running Group ICA on this data, you need to turn off all preprocessing, or use the command line (after transforming the data into a common space using, e.g. featregapply). <span class="anchor" id="line-148"></span><span class="anchor" id="line-149"></span><p class="line867"><hr /><p class="line874"> <span class="anchor" id="line-150"></span>
<h1 id="Using_melodic_for_just_doing_mixture-modelling">Using melodic for just doing mixture-modelling</h1>
<span class="anchor" id="line-151"></span><span class="anchor" id="line-152"></span><p class="line874">The following explains how to apply melodic's mixture modelling to a statistic image, without actually running ICA. This can be useful when you have a statistic image that is nominally a z-statistic, but where there is a chance that it is not valid - for example if the null central part of the distribution does not have zero mean and unity standard deviation (e.g., because your data was temporally smooth, and that was not taken into account when you ran a GLM and created the z-statistic).  The mixture-modelling will fit curves to the null and non-null parts of the image histogram, and force the null part of the adjusted statistic image to have zero mean and unity standard deviation. <span class="anchor" id="line-153"></span><span class="anchor" id="line-154"></span><p class="line874">First, create a dummy file whose contents are irrelevant - this is necessary in order to make melodic run without the full ICA estimation: <span class="anchor" id="line-155"></span><span class="anchor" id="line-156"></span><p class="line867"><tt>echo&nbsp;"1"&nbsp;&gt;&nbsp;grot.txt</tt> <span class="anchor" id="line-157"></span><span class="anchor" id="line-158"></span><p class="line862">Then, feed your stats image <tt>myZstat</tt> into the mixture-modelling: <span class="anchor" id="line-159"></span><span class="anchor" id="line-160"></span><p class="line867"><tt>melodic&nbsp;-i&nbsp;myZstat&nbsp;--ICs=myZstat&nbsp;--mix=grot.txt&nbsp;-o&nbsp;myZstatMM&nbsp;--Oall&nbsp;--report&nbsp;-v&nbsp;--mmthresh=0</tt> <span class="anchor" id="line-161"></span><span class="anchor" id="line-162"></span><p class="line862">The corrected stats image will be named <tt>myZstatMM/stats/thresh_zstat1</tt> - this will be corrected and not thresholded, the latter being because of the option <tt>--mmthresh=0</tt> .  If you wish to adjust the z-statistic and also apply mixture-model-based thresholding (in the same manner as melodic does in normal ICA usage), then set this to (e.g.) 0.5 to get an equal balance between false positives and false negatives. <span class="anchor" id="line-163"></span><span class="anchor" id="line-164"></span><p class="line867"><hr /><p class="line874"> <span class="anchor" id="line-165"></span><a href="./CategoryFunctional.html">CategoryFunctional</a> <a href="./CategoryMELODIC.html">CategoryMELODIC</a> <span class="anchor" id="line-166"></span><span class="anchor" id="bottom"></span></div>
</div>
<hr>
2014-07-08 15:34
</body>
</html>
